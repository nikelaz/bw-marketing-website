---
import * as stylex from '@stylexjs/stylex';
import FooterLayout from './footer-layout.astro';
import { Container, Row, Col } from '../components/grid';
import Header from '../components/header';
import Section from '../components/section';
import Stack from '../components/stack';
import Breadcrumb from '../components/breadcrumb';
import GuidesSidebar from '../components/guides-sidebar';

export interface Props {
	title?: string;
	description?: string;
	currentGuideTitle: string;
	categories: Array<{
		name: string;
		articles: Array<{
			id: string;
			title: string;
			category: string;
			order: number;
		}>;
	}>;
	currentSlug?: string;
}

const { title, description, categories, currentSlug, currentGuideTitle } = Astro.props;
const currentPath = new URL(Astro.request.url).pathname;

export const styles = stylex.create({
	layout: {
		display: 'flex',
		gap: '2rem',
	},
	sidebar: {
		width: '280px',
		flexShrink: 0,
	},
	content: {
		flex: 1,
		minWidth: 0,
	},
});
---

<FooterLayout title={title} description={description}>
	<Container>
		<Header client:idle currentPath={currentPath} />
	</Container>
	<Section>
		<Container>
			<Stack gap="lg">
				<Breadcrumb items={[
					{ label: 'Support', href: '/support' },
					{ label: 'User Guides', href: '/support/guides' },
					{ label: currentGuideTitle }
				]} />
				<Row largeGutter={true}>
				<Col span={3} break="lg" largeGutter={true}>
					<GuidesSidebar 
						categories={categories} 
						currentSlug={currentSlug} 
						client:load 
					/>
				</Col>
				<Col span={9} break="lg" largeGutter={true}>
					<slot />
				</Col>
				</Row>
			</Stack>
		</Container>
	</Section>
</FooterLayout>
